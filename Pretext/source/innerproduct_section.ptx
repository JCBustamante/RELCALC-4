<section xml:id="innerproduct_section">
  <title>Inner product and projections</title>
  <subsection>
    <title>Inner product and orthogonality</title>
    <p>
      To do basic geometry, we need length, and we need angles.
      We have already seen the euclidean length,
      so let us figure out how to compute angles.
      Mostly, we are worried about the right angle<fn>
      When Euclid defined angles in his <em>Elements</em>,
      the only angle he ever really defined was the right angle.
      </fn>.
    </p>
    <p>
      Given two (column) vectors in <m>{\mathbb{R}}^n</m>,
      we define the (standard) <em>inner product
          <idx><h>inner product</h></idx>
      </em>
          <idx><h>standard inner product</h></idx>
      as the dot product:
      <me>
        \langle \vec{x} , \vec{y} \rangle = \vec{x} \cdot \vec{y} = \vec{y}^T \vec{x} = \sum_{i=1}^n x_i y_i
      </me>.
    </p>
    <p>
      Why do we seemingly give a new notation for the dot product?
      Because there are other possible inner products,
      which are not the dot product,
      although we will not worry about others here.
      An inner product can even be defined on spaces of functions as we do in <xref ref="FS_chapter"></xref>:
      <me>
        \langle f(t) , g(t) \rangle = \int_{a}^{b} f(t) g(t) \, dt
      </me>.
    </p>
    <p>
      But we digress.
    </p>
    <p>
      Inner product satisfies the following rules
      <ol marker="i">
        <li>
          <p>
            <m>\langle \vec{x} , \vec{x} \rangle \geq 0</m>,
            and <m>\langle \vec{x} , \vec{x} \rangle = 0</m> if and only if <m>\vec{x} = 0</m>,
          </p>
        </li>
        <li>
          <p>
            <m>\langle \vec{x} , \vec{y} \rangle = \langle \vec{y} , \vec{x} \rangle</m>,
          </p>
        </li>
        <li>
          <p>
            <m>\langle a\vec{x} , \vec{y} \rangle = \langle \vec{x} , a\vec{y} \rangle = a \langle \vec{x} , \vec{y} \rangle</m>,
          </p>
        </li>
        <li>
          <p>
            <m>\langle \vec{x} + \vec{y} , \vec{z} \rangle = \langle \vec{x} , \vec{z} \rangle + \langle \vec{y} , \vec{z} \rangle</m> and <m>\langle \vec{x}, \vec{y} + \vec{z} \rangle = \langle \vec{x} , \vec{y} \rangle + \langle \vec{x} , \vec{z} \rangle</m>.
          </p>
        </li>
      </ol>
    </p>
    <p>
      In fact, anything that satisfies the properties above can be called an inner product,
      although in this section we are concerned with the standard inner product in <m>{\mathbb{R}}^n</m>.
    </p>
    <p>
      The standard inner product gives the euclidean length:
      <me>
        \lVert{\vec{x}}\rVert = \sqrt{\langle \vec{x}, \vec{x} \rangle} = \sqrt{x_1^2 + x_2^2 + \cdots + x_n^2}
      </me>.
    </p>
    <p>
      How does it give angles?
    </p>
    <p>
      You may recall from multivariable calculus,
      that in two or three dimensions,
      the standard inner product gives you the angle as you know from plane or three dimensional geometry:
      <me>
        \langle \vec{x}, \vec{y} \rangle = \lVert{\vec{x}}\rVert \lVert{\vec{y}}\rVert \cos \theta
      </me>.
    </p>
    <p>
      That is, <m>\theta</m> is the angle that <m>\vec{x}</m> and <m>\vec{y}</m> make when they are based at the same point.
    </p>
    <p>
      In <m>{\mathbb{R}}^n</m>,
      we are simply going to say that <m>\theta</m> from the formula is what the angle is.
      This makes sense as any two vectors based at the origin lie in a 2-dimensional plane (subspace),
      and the formula works in 2 dimensions.
      In fact, one could even talk about angles between functions this way,
      and we do in <xref ref="FS_chapter"></xref>,
      where we talk about orthogonal functions
      (functions at right angle to each other).
    </p>
    <p>
      To compute the angle we compute
      <me>
        \cos \theta = \frac{\langle \vec{x}, \vec{y} \rangle}{\lVert{\vec{x}}\rVert \lVert{\vec{y}}\rVert}
      </me>.
    </p>
    <p>
      Our angles are always in radians.
      We are computing the cosine of the angle,
      which is really the best we can do.
      Given two vectors at an angle <m>\theta</m>,
      we can give the angle as <m>-\theta</m>,
      <m>2\pi-\theta</m>, etc., <xref ref="vec-angle_fig">see</xref>.
      Fortunately,
      <m>\cos \theta = \cos (-\theta) = \cos(2\pi - \theta)</m>.
      If we solve for <m>\theta</m> using the inverse cosine <m>\cos^{-1}</m>,
      we can just decree that <m>0 \leq \theta \leq \pi</m>.
    </p>
    <figure xml:id="vec-angle_fig">
      <caption>Angle between vectors.</caption>
      <image width="73%" source="vec-angle"/>
    </figure>
    <example>
      <statement>
        <p>
          Let us compute the angle between the vectors <m>(3,0)</m> and <m>(1,1)</m> in the plane.
          Compute
          <me>
            \cos \theta = \frac{\bigl\langle (3,0) , (1,1) \bigr\rangle}{\lVert(3,0)\rVert \lVert(1,1)\rVert} = \frac{3 + 0}{3 \sqrt{2}} = \frac{1}{\sqrt{2}}
          </me>.
        </p>
        <p>
          Therefore <m>\theta = \nicefrac{\pi}{4}</m>.
        </p>
      </statement>
    </example>
    <p>
      As we said, the most important angle is the right angle.
      A right angle is <m>\nicefrac{\pi}{2}</m> radians,
      and <m>\cos (\nicefrac{\pi}{2}) = 0</m>,
      so the formula is particularly easy in this case.
      We say vectors <m>\vec{x}</m> and <m>\vec{y}</m> are <em>orthogonal
          <idx><h>orthogonal</h></idx>
      </em> if they are at right angles, that is if
      <me>
        \langle \vec{x} , \vec{y} \rangle = 0
      </me>.
    </p>
    <p>
      The vectors <m>(1,0,0,1)</m> and <m>(1,2,3,-1)</m> are orthogonal.
      So are <m>(1,1)</m> and <m>(1,-1)</m>.
      However, <m>(1,1)</m> and <m>(1,2)</m> are not orthogonal as their inner product is <m>3</m> and not 0.
    </p>
  </subsection>
  <subsection>
    <title>Orthogonal projection</title>
    <p>
      A typical application of linear algebra is to take a difficult problem,
      write everything in the right basis,
      and in this new basis the problem becomes simple.
      A particularly useful basis is an orthogonal basis,
      that is a basis where all the basis vectors are orthogonal.
      When we draw a coordinate system in two or three dimensions,
      we almost always draw our axes as orthogonal to each other.
    </p>
    <p>
      Generalizing this concept to functions,
      it is particularly useful in <xref ref="FS_chapter"></xref>
      to express a function using a particular orthogonal basis,
      the Fourier series.
    </p>
    <p>
      To express one vector in terms of an orthogonal basis,
      we need to first <em>project</em> one vector onto another.
      Given a nonzero vector <m>\vec{v}</m>,
      we define the <em>orthogonal projection
          <idx><h>orthogonal projection</h></idx>
      </em><idx><h>projection</h><h>orthogonal</h></idx> of <m>\vec{w}</m> onto <m>\vec{v}</m> as
      <me>
        \operatorname{proj}_{\vec{v}}(\vec{w}) = \left( \frac{\langle \vec{w} , \vec{v} \rangle}{ \langle \vec{v} , \vec{v} \rangle} \right) \vec{v}
      </me>.
    </p>
    <p>
      For the geometric idea, <xref ref="vec-orthoproj_fig">see</xref>.
      That is, we find the
      <q>shadow of <m>\vec{w}</m></q>
      on the line spanned by <m>\vec{v}</m> if the direction of the sun's rays were exactly perpendicular to the line.
      Another way of thinking about it is that the tip of the arrow of
      <m>\operatorname{proj}_{\vec{v}}(\vec{w})</m> is the closest point on the line spanned by <m>\vec{v}</m> to the tip of the arrow of <m>\vec{w}</m>.
      In terms of euclidean distance,
      <m>\vec{u} = \operatorname{proj}_{\vec{v}}(\vec{w})</m> minimizes the distance
      <m>\lVert \vec{w} - \vec{u} \rVert</m> among all vectors <m>\vec{u}</m> that are multiples of <m>\vec{v}</m>.
      Because of this,
      this projection comes up often in applied mathematics in all sorts of contexts we cannot solve a problem exactly: We can't always solve
      <q>Find <m>\vec{w}</m> as a multiple of <m>\vec{v}</m>,</q>
      but <m>\operatorname{proj}_{\vec{v}}(\vec{w})</m> is the best
      <q>solution.</q>
    </p>
    <figure xml:id="vec-orthoproj_fig">
      <caption>Orthogonal projection.</caption>
      <image width="73%" source="vec-orthoproj"/>
    </figure>
    <p>
      The formula follows from basic trigonometry.
      The length of <m>\operatorname{proj}_{\vec{v}}(\vec{w})</m> should be
      <m>\cos \theta</m> times the length of <m>\vec{w}</m>,
      that is <m>(\cos \theta)\lVert\vec{w}\rVert</m>.
      We take the unit vector in the direction of <m>\vec{v}</m>, that is,
      <m>\frac{\vec{v}}{\lVert \vec{v} \rVert}</m> and we multiply it by the length of the projection.
      In other words,
      <me>
        \operatorname{proj}_{\vec{v}}(\vec{w}) = (\cos \theta) \lVert \vec{w} \rVert \frac{\vec{v}}{\lVert \vec{v} \rVert} = \frac{(\cos \theta) \lVert \vec{w} \rVert \lVert \vec{v} \rVert}{ {\lVert \vec{v} \rVert}^2 } \vec{v} = \frac{\langle \vec{w}, \vec{v} \rangle}{ \langle \vec{v}, \vec{v} \rangle } \vec{v}
      </me>.
    </p>
    <example>
      <statement>
        <p>
          Suppose we wish to project the vector <m>(1,2,3)</m> onto the vector <m>(3,2,1)</m>.
          Compute
          <me>
            \begin{split} \operatorname{proj}_{(1,2,3)} \bigl( (3,2,1) \bigr) = \frac{\langle (3,2,1) , (1,2,3) \rangle}{\langle (1,2,3) , (1,2,3) \rangle} (1,2,3) \amp  = \frac{3 \cdot 1 + 2 \cdot 2 + 1 \cdot 3}{ 1 \cdot 1 + 2 \cdot 2 + 3 \cdot 3} (1,2,3) \\ \amp  = \frac{10}{14} (1,2,3) = \left(\frac{5}{7},\frac{10}{7},\frac{15}{7}\right) . \end{split}
          </me>
        </p>
        <p>
          Let us double check that the projection is orthogonal.
          That is <m>\vec{w}-\operatorname{proj}_{\vec{v}}(\vec{w})</m> ought to be orthogonal to <m>\vec{v}</m>,
          see the right angle in <xref ref="vec-orthoproj_fig"></xref>.
          That is,
          <me>
            (3,2,1) - \operatorname{proj}_{(1,2,3)} \bigl( (3,2,1) \bigr) = \left(3-\frac{5}{7},2-\frac{10}{7},1-\frac{15}{7}\right) = \left(\frac{16}{7},\frac{4}{7},\frac{-8}{7}\right)
          </me>
          ought to be orthogonal to <m>(1,2,3)</m>.
          We compute the inner product and we had better get zero:
          <me>
            \left\langle \left(\frac{16}{7},\frac{4}{7},\frac{-8}{7}\right) , (1,2,3) \right\rangle = \frac{16}{7} \cdot 1 + \frac{4}{7} \cdot 2 -\frac{8}{7} \cdot 3 = 0
          </me>.
        </p>
      </statement>
    </example>
  </subsection>
  <subsection>
    <title>Orthogonal basis</title>
    <p>
      As we said, a basis <m>\vec{v}_1,\vec{v}_2,\ldots,\vec{v}_n</m> is an <em>orthogonal basis
          <idx><h>orthogonal basis</h></idx>
      </em> if all vectors in the basis are orthogonal to each other,
      that is, if
      <me>
        \langle \vec{v}_j , \vec{v}_k \rangle = 0
      </me>
      for all choices of <m>j</m> and <m>k</m> where
      <m>j \not= k</m> (a nonzero vector cannot be orthogonal to itself).
      A basis is furthermore called an <em>orthonormal basis
          <idx><h>orthonormal basis</h></idx>
      </em> if all the vectors in a basis are also unit vectors, that is,
      if all the vectors have magnitude 1.
      For example, the standard basis
      <m>\{ (1,0,0), (0,1,0), (0,0,1) \}</m> is an orthonormal basis of
      <m>{\mathbb{R}}^3</m>: Any pair is orthogonal,
      and each vector is of unit magnitude.
    </p>
    <p>
      The reason why we are interested in orthogonal
      (or orthonormal)
      bases is that they make it really simple to represent a vector
      (or a projection onto a subspace)
      in the basis.
      The simple formula for the orthogonal projection onto a vector gives us the coefficients.
      <xref ref="FS_chapter">In</xref> we use the same idea by finding the correct orthogonal basis for the set of solutions of a differential equation we are then able to find any particular solution by simply applying the orthogonal projection formula,
      which is just a couple of a inner products.
    </p>
    <p>
      Let us come back to linear algebra.
      Suppose that we have a subspace and an orthogonal basis <m>\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n</m>.
      We wish to express <m>\vec{x}</m> in terms of the basis.
      If <m>\vec{x}</m> is not in the span of the basis
      (when it is not in the given subspace),
      then of course it is not possible,
      but the following formula gives us at least the orthogonal projection onto the subspace.
    </p>
    <p>
      First suppose that <m>\vec{x}</m> is in the span.
      Then it is the sum of the orthogonal projections:
      <me>
        \vec{x} = \operatorname{proj}_{\vec{v}_1} ( \vec{x} ) + \operatorname{proj}_{\vec{v}_2} ( \vec{x} ) + \cdots + \operatorname{proj}_{\vec{v}_n} ( \vec{x} ) = \frac{\langle \vec{x}, \vec{v}_1 \rangle}{ \langle \vec{v}_1, \vec{v}_1 \rangle } \vec{v}_1 + \frac{\langle \vec{x}, \vec{v}_2 \rangle}{ \langle \vec{v}_2, \vec{v}_2 \rangle } \vec{v}_2 + \cdots + \frac{\langle \vec{x}, \vec{v}_n \rangle}{ \langle \vec{v}_n, \vec{v}_n \rangle } \vec{v}_n
      </me>.
    </p>
    <p>
      In other words,
      if we want to write <m>\vec{x} = a_1 \vec{v}_1 + a_2 \vec{v}_2 + \cdots + a_n \vec{v}_n</m>, then
      <me>
        a_1 = \frac{\langle \vec{x}, \vec{v}_1 \rangle}{ \langle \vec{v}_1, \vec{v}_1 \rangle } , a_2 = \frac{\langle \vec{x}, \vec{v}_2 \rangle}{ \langle \vec{v}_2, \vec{v}_2 \rangle } ,  \ldots , a_n = \frac{\langle \vec{x}, \vec{v}_n \rangle}{ \langle \vec{v}_n, \vec{v}_n \rangle }
      </me>.
    </p>
    <p>
      Another way to derive this formula is to work in reverse.
      Suppose that <m>\vec{x} = a_1 \vec{v}_1 + a_2 \vec{v}_2 + \cdots + a_n \vec{v}_n</m>.
      Take an inner product with <m>\vec{v}_j</m>,
      and use the properties of the inner product:
      <me>
        \begin{split} \langle \vec{x} , \vec{v}_j \rangle \amp  = \langle a_1 \vec{v}_1 + a_2 \vec{v}_2 + \cdots + a_n \vec{v}_n , \vec{v}_j \rangle \\ \amp  = a_1 \langle \vec{v}_1 , \vec{v}_j \rangle + a_2 \langle \vec{v}_2 , \vec{v}_j \rangle + \cdots + a_n \langle \vec{v}_n , \vec{v}_j \rangle . \end{split}
      </me>
    </p>
    <p>
      As the basis is orthogonal,
      then <m>\langle \vec{v}_k , \vec{v}_j \rangle = 0</m> whenever <m>k \not= j</m>.
      That means that only one of the terms,
      the <m>j^{\text{ th } }</m> one,
      on the right hand side is nonzero and we get
      <me>
        \langle \vec{x} , \vec{v}_j \rangle = a_j \langle \vec{v}_j , \vec{v}_j \rangle
      </me>.
    </p>
    <p>
      Solving for <m>a_j</m> we find <m>a_j = \frac{\langle \vec{x}, \vec{v}_j \rangle}{ \langle \vec{v}_j, \vec{v}_j \rangle }</m> as before.
    </p>
    <example>
      <statement>
        <p>
          The vectors <m>(1,1)</m> and <m>(1,-1)</m> form an orthogonal basis of <m>{\mathbb{R}}^2</m>.
          Suppose we wish to represent <m>(3,4)</m> in terms of this basis, that is,
          we wish to find <m>a_1</m> and <m>a_2</m> such that
          <me>
            (3,4) = a_1 (1,1) + a_2 (1,-1)
          </me>.
        </p>
        <p>
          We compute:
          <me>
            a_1 = \frac{\langle (3,4), (1,1) \rangle}{ \langle (1,1), (1,1) \rangle } = \frac{7}{2}, \qquad a_2 = \frac{\langle (3,4), (1,-1) \rangle}{ \langle (1,-1), (1,-1) \rangle } = \frac{-1}{2}
          </me>.
        </p>
        <p>
          So
          <me>
            (3,4) = \frac{7}{2} (1,1) + \frac{-1}{2} (1,-1)
          </me>.
        </p>
      </statement>
    </example>
    <p>
      If the basis is orthonormal rather than orthogonal,
      than the denominators are always just one.
      It is easy to make a basis orthonormal,
      just by dividing all the vectors by their size.
      If you want to decompose many vectors,
      it may be better to find an orthonrmal basis.
      In the example above, the orthonormal basis we would thus create is
      <me>
        \left( \frac{1}{\sqrt{2}} , \frac{1}{\sqrt{2}} \right) , \left( \frac{1}{\sqrt{2}} , \frac{-1}{\sqrt{2}} \right)
      </me>.
    </p>
    <p>
      Then the computation would have been
      <me>
        \begin{split} (3,4) \amp  = \left\langle (3,4) , \left( \frac{1}{\sqrt{2}} , \frac{1}{\sqrt{2}} \right) \right\rangle \left( \frac{1}{\sqrt{2}} , \frac{1}{\sqrt{2}} \right) + \left\langle (3,4) , \left( \frac{1}{\sqrt{2}} , \frac{-1}{\sqrt{2}} \right) \right\rangle \left( \frac{1}{\sqrt{2}} , \frac{-1}{\sqrt{2}} \right) \\ \amp  = \frac{7}{\sqrt{2}} \left( \frac{1}{\sqrt{2}} , \frac{1}{\sqrt{2}} \right) + \frac{-1}{\sqrt{2}} \left( \frac{1}{\sqrt{2}} , \frac{-1}{\sqrt{2}} \right) . \end{split}
      </me>
    </p>
    <p>
      Maybe the example is not so awe inspiring,
      but given vectors in <m>{\mathbb{R}}^{20}</m> rather than <m>{\mathbb{R}}^2</m>,
      then surely one would much rather do 20 inner products (or 40 if we did not have an orthonormal basis) rather than solving a system of twenty equations in twenty unknowns using row reduction of a <m>20 \times 21</m> matrix.
    </p>
    <p>
      As we said above,
      the formula still works even if <m>\vec{x}</m> is not in the subspace,
      although then it does not get us the vector <m>\vec{x}</m> but its projection.
      More concretely,
      suppose that <m>S</m> is a subspace that is the span of
      <m>\vec{v}_1,\vec{v}_2,\ldots,\vec{v}_n</m> and <m>\vec{x}</m> is any vector.
      Let <m>\operatorname{proj}_{S}(\vec{x})</m> be the vector in <m>S</m> that is the closest to <m>\vec{x}</m>.
      Then
      <me>
        \operatorname{proj}_{S}(\vec{x}) = \frac{\langle \vec{x}, \vec{v}_1 \rangle}{ \langle \vec{v}_1, \vec{v}_1 \rangle } \vec{v}_1 + \frac{\langle \vec{x}, \vec{v}_2 \rangle}{ \langle \vec{v}_2, \vec{v}_2 \rangle } \vec{v}_2 + \cdots + \frac{\langle \vec{x}, \vec{v}_n \rangle}{ \langle \vec{v}_n, \vec{v}_n \rangle } \vec{v}_n
      </me>.
    </p>
    <p>
      Of course, if <m>\vec{x}</m> is in <m>S</m>,
      then <m>\operatorname{proj}_{S}(\vec{x}) = \vec{x}</m>,
      as the closest vector in <m>S</m> to <m>\vec{x}</m> is <m>\vec{x}</m> itself.
      But true utility is obtained when <m>\vec{x}</m> is not in <m>S</m>.
      In much of applied mathematics we cannot find an exact solution to a problem,
      but we try to find the best solution out of a small subset
      (subspace).
      The partial sums of Fourier series from <xref ref="FS_chapter"></xref> are one example.
      Another example is least square approximation to fit a curve to data.
      Yet another example is given by the most commonly used numerical methods to solve differential equations,
      the finite element methods.
    </p>
    <example>
      <statement>
        <p>
          The vectors <m>(1,2,3)</m> and <m>(3,0,-1)</m> are orthogonal,
          and so they are an orthogonal basis of a subspace <m>S</m>:
          <me>
            S = \operatorname{span} \bigl\{ (1,2,3), (3,0,-1) \bigr\}
          </me>.
        </p>
        <p>
          Let us find the vector in <m>S</m> that is closest to <m>(2,1,0)</m>.
          That is, let us find <m>\operatorname{proj}_{S}\bigl((2,1,0)\bigr)</m>.
          <me>
            \begin{split} \operatorname{proj}_{S}\bigl((2,1,0)\bigr) \amp  = \frac{\langle (2,1,0), (1,2,3) \rangle}{ \langle (1,2,3), (1,2,3) \rangle } (1,2,3) + \frac{\langle (2,1,0), (3,0,-1) \rangle}{ \langle (3,0,-1), (3,0,-1) \rangle } (3,0,-1) \\ \amp  = \frac{2}{7} (1,2,3) + \frac{3}{5} (3,0,-1) \\ \amp = \left( \frac{73}{35} , \frac{4}{7} , \frac{9}{35} \right) . \end{split}
          </me>
        </p>
      </statement>
    </example>
  </subsection>
  <subsection>
    <title>The Gram<ndash/>Schmidt process</title>
    <p>
      Before leaving orthogonal bases,
      let us note a procedure for manufacturing them out of any old basis.
      It may not be difficult to come up with an orthogonal basis for a 2-dimensional subspace,
      but for a 20-dimensional subspace, it seems a daunting task.
      Fortunately, the orthogonal projection can be used to
      <q>project away</q>
      the bits of the vectors that are making them not orthogonal.
      It is called the <em>Gram<ndash/>Schmidt process<idx><h>Gram<ndash/>Schmidt process</h></idx>
      </em>.
    </p>
    <p>
      We start with a basis of vectors <m>\vec{v}_1,\vec{v}_2, \ldots, \vec{v}_n</m>.
      We construct an orthogonal basis <m>\vec{w}_1, \vec{w}_2, \ldots, \vec{w}_n</m> as follows.
      <md>
        <mrow>\vec{w}_1 \amp  = \vec{v}_1 , \displaybreak[0]</mrow>
        <mrow>\vec{w}_2 \amp  = \vec{v}_2 - \operatorname{proj}_{\vec{w}_1}(\vec{v}_2) , \displaybreak[0]</mrow>
        <mrow>\vec{w}_3 \amp  = \vec{v}_3 - \operatorname{proj}_{\vec{w}_1}(\vec{v}_3) - \operatorname{proj}_{\vec{w}_2}(\vec{v}_3) , \displaybreak[0]</mrow>
        <mrow>\vec{w}_4 \amp  = \vec{v}_4 - \operatorname{proj}_{\vec{w}_1}(\vec{v}_4) - \operatorname{proj}_{\vec{w}_2}(\vec{v}_4) - \operatorname{proj}_{\vec{w}_3}(\vec{v}_4) ,</mrow>
        <mrow>\amp  \vdots</mrow>
        <mrow>\vec{w}_n \amp  = \vec{v}_n - \operatorname{proj}_{\vec{w}_1}(\vec{v}_n) - \operatorname{proj}_{\vec{w}_2}(\vec{v}_n) - \cdots - \operatorname{proj}_{\vec{w}_{n-1}}(\vec{v}_n) </mrow>
      </md>.
    </p>
    <p>
      What we do is at the <m>k^{\text{ th } }</m> step,
      we take <m>\vec{v}_k</m> and we subtract the projection of
      <m>\vec{v}_k</m> to the subspace spanned by <m>\vec{w}_1,\vec{w}_2,\ldots,\vec{w}_{k-1}</m>.
    </p>
    <example>
      <statement>
        <p>
          Consider the vectors <m>(1,2,-1)</m>,
          and <m>(0,5,-2)</m> and call <m>S</m> the span of the two vectors.
          Let us find an orthogonal basis of <m>S</m>:
          <md>
            <mrow>\vec{w}_1 \amp  = (1,2,-1) ,</mrow>
            <mrow>\vec{w}_2 \amp  = (0,5,-2) - \operatorname{proj}_{(1,2,-1)}\bigl((0,2,-2)\bigr)</mrow>
            <mrow>\amp  = (0,1,-1) - \frac{\langle (0,5,-2), (1,2,-1) \rangle}{ \langle (1,2,-1), (1,2,-1) \rangle } (1,2,-1) = (0,5,-2) - 2 (1,2,-1) = (-2,1,0) </mrow>
          </md>.
        </p>
        <p>
          So <m>(1,2,-1)</m> and <m>(-2,1,0)</m> span <m>S</m> and are orthogonal.
          Let us check: <m>(1,2,-1) \cdot (-2,1,0) = 0</m>.
        </p>
        <p>
          Suppose we wish to find an orthonormal basis,
          not just an orthogonal one.
          Well, we simply make the vectors into unit vectors by dividing them by their magnitude.
          The two vectors making up the orthonormal basis of <m>S</m> are:
          <me>
            \frac{1}{\sqrt{6}} (1,2,-1) = \left( \frac{1}{\sqrt{6}}, \frac{2}{\sqrt{6}}, \frac{-1}{\sqrt{6}} \right) , \qquad \frac{1}{\sqrt{5}} (-2,1,0) = \left( \frac{-2}{\sqrt{5}}, \frac{1}{\sqrt{5}}, 0 \right)
          </me>.
        </p>
      </statement>
    </example>
  </subsection>
  <subsection>
    <title>Exercises</title>
    <exercise>
      <statement>
        <p>
          Find the <m>s</m> that makes the following vectors orthogonal:
          <m>(1,2,3)</m>, <m>(1,1,s)</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Find the angle <m>\theta</m> between <m>(1,3,1)</m>, <m>(2,1,-1)</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Given that <m>\langle \vec{v} , \vec{w} \rangle = 3</m> and
          <m>\langle \vec{v} , \vec{u} \rangle = -1</m> compute \begin{tasks}(3) \task <m>\langle \vec{u} , 2 \vec{v} \rangle</m> \task
          <m>\langle \vec{v} , 2 \vec{w} + 3 \vec{u} \rangle</m> \task <m>\langle \vec{w} + 3 \vec{u}, \vec{v} \rangle</m> \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Suppose <m>\vec{v} = (1,1,-1)</m>.
          Find \begin{tasks}(3) \task <m>\operatorname{proj}_{\vec{v}}\bigl( (1,0,0) \bigr)</m> \task
          <m>\operatorname{proj}_{\vec{v}}\bigl( (1,2,3) \bigr)</m> \task <m>\operatorname{proj}_{\vec{v}}\bigl( (1,-1,0) \bigr)</m> \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <title>2</title>
      <statement>
        <p>
          Consider the vectors <m>(1,2,3)</m>, <m>(-3,0,1)</m>,
          <m>(1,-5,3)</m>. \begin{tasks}(2) \task Check that the vectors are linearly independent and so form a basis. \task Check that the vectors are mutually orthogonal,
          and are therefore an orthogonal basis. \task Represent <m>(1,1,1)</m> as a linear combination of this basis. \task Make the basis orthonormal. \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Let <m>S</m> be the subspace spanned by <m>(1,3,-1)</m>,
          <m>(1,1,1)</m>.
          Find an orthogonal basis of <m>S</m> by the Gram-Schmidt process.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Starting with <m>(1,2,3)</m>,
          <m>(1,1,1)</m>, <m>(2,2,0)</m>,
          follow the Gram-Schmidt process to find an orthogonal basis of <m>{\mathbb{R}}^3</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Find an orthogonal basis of <m>{\mathbb{R}}^3</m> such that
          <m>(3,1,-2)</m> is one of the vectors.
          Hint: First find two extra vectors to make a linearly independent set.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Using cosines and sines of <m>\theta</m>,
          find a unit vector <m>\vec{u}</m> in
          <m>{\mathbb{R}}^2</m> that makes angle <m>\theta</m> with <m>\vec{\imath} = (1,0)</m>.
          What is <m>\langle \vec{\imath} , \vec{u} \rangle</m>?
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Find the <m>s</m> that makes the following vectors orthogonal:
          <m>(1,1,1)</m>, <m>(1,s,1)</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>s=-2</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Find the angle <m>\theta</m> between <m>(1,2,3)</m>, <m>(1,1,1)</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>\theta \approx 0.3876</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Given that <m>\langle \vec{v} , \vec{w} \rangle = 1</m> and <m>\langle \vec{v} , \vec{u} \rangle = -1</m> and
          <m>\lVert \vec{v} \rVert = 3</m> and \begin{tasks}(3) \task <m>\langle 3 \vec{u} , 5 \vec{v} \rangle</m> \task
          <m>\langle \vec{v} , 2 \vec{w} + 3 \vec{u} \rangle</m> \task <m>\langle \vec{w} + 3 \vec{v}, \vec{v} \rangle</m> \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> a)<nbsp/>-15 b)<nbsp/>-1 c)<nbsp/>28 }
    </p>
    <exercise>
      <statement>
        <p>
          Suppose <m>\vec{v} = (1,0,-1)</m>.
          Find \begin{tasks}(3) \task <m>\operatorname{proj}_{\vec{v}}\bigl( (0,2,1) \bigr)</m> \task
          <m>\operatorname{proj}_{\vec{v}}\bigl( (1,0,1) \bigr)</m> \task <m>\operatorname{proj}_{\vec{v}}\bigl( (4,-1,0) \bigr)</m> \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> a)<nbsp/><m>(\nicefrac{-1}{2},0,\frac{1}{2})</m> b)<nbsp/><m>(0,0,0)</m> c)<nbsp/><m>(2,0,-2)</m> }
    </p>
    <exercise>
      <statement>
        <p>
          The vectors <m>(1,1,-1)</m>,
          <m>(2,-1,1)</m>, <m>(1,-5,3)</m> for an orthonormal basis.
          Represent the following vectors in terms of this basis. \begin{tasks}(3) \task <m>(1,-8,4)</m> \task
          <m>(5,-7,5)</m> \task <m>(0,-6,2)</m> \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> a)<nbsp/><m>(1,1,-1)-(2,-1,1)+2(1,-5,3)</m> b)<nbsp/><m>2(2,-1,1)+(1,-5,3)</m> c)<nbsp/><m>2(1,1,-1)-2(2,-1,1)+2(1,-5,3)</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Let <m>S</m> be the subspace spanned by <m>(2,-1,1)</m>,
          <m>(2,2,2)</m>.
          Find an orthogonal basis of <m>S</m> by the Gram-Schmidt process.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>(2,-1,1)</m>,
      <m>(\nicefrac{2}{3},\nicefrac{8}{3},\nicefrac{4}{3})</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Starting with <m>(1,1,-1)</m>,
          <m>(2,3,-1)</m>, <m>(1,-1,1)</m>,
          follow the Gram-Schmidt process to find an orthogonal basis of <m>{\mathbb{R}}^3</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>(1,1,-1)</m>,
      <m>(0,1,1)</m>,
      <m>(\nicefrac{4}{3},\nicefrac{-2}{3},\nicefrac{2}{3})</m> }
    </p>
  </subsection>
</section>