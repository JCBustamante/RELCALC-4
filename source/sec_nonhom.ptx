<section xml:id="sec_nonhom">
  <title>&#xc9;quations non homog&#xe8;nes</title>
  <subsection>
    <title>R&#xe9;soudre des &#xe9;quations non homog&#xe8;nes</title>
    <p>
      On a r&#xe9;solu des &#xe9;quations lin&#xe9;aires homog&#xe8;nes &#xe0;
      coefficients constants.
      Qu'en est-il des &#xe9;quations qui ne sont pas homog&#xe8;nes?
      Par exemple,
      celles pour les forces de vibration m&#xe9;canique.
    </p>
    <p>
      Consid&#xe9;rons, par exemple:
      <men xml:id="eq3_5_nh">
        y'' + 5y'+ 6y = 2x+1
      </men>.
    </p>
    <p>
      On &#xe9;crit <m>Ly = 2x+1</m> lorsque la forme exacte de l'op&#xe9;rateur n'est pas importante.
      On r&#xe9;sout <xref ref="eq3_5_nh"/> de la mani&#xe8;re suivante.
      Premi&#xe8;rement,
      on trouve la solution g&#xe9;n&#xe9;rale <m>y_c</m> &#xe0;
      l'<em>&#xe9;quation homog&#xe8;ne associ&#xe9;e<idx><h>&#xe9;quation homog&#xe8;ne associ&#xe9;e</h></idx>
      </em>:
      <men xml:id="eq3_5_h">
        y'' + 5y'+ 6y = 0
      </men>.
    </p>
    <p>
      On nomme <m>y_c</m> la <em>solution compl&#xe9;mentaire<idx><h>solution compl&#xe9;mentaire</h></idx>
      </em>.
      Deuxi&#xe8;mement, on trouve une seule
      <em>solution particuli&#xe8;re<idx><h>solution particuli&#xe8;re</h></idx>
      </em> <m>y_p</m> &#xe0; <xref ref="eq3_5_nh"/>, d'une mani&#xe8;re quelconque.
      La solution g&#xe9;n&#xe9;rale &#xe0;
      <xref ref="eq3_5_nh"/> est alors:
      <me>
        y = y_c + y_p
      </me>.
    </p>
    <p>
      On a <m>L y_c = 0</m> et <m>L y_p = 2x+1</m>.
      Comme <m>L</m> est un <em>op&#xe9;rateur lin&#xe9;aire<idx><h>op&#xe9;rateur lin&#xe9;aire</h></idx>
      </em>, <m>L y = L ( y_c + y_p) = L y_c + L y_p = 0 + (2x+1)</m>,
      et donc <m>y</m> est une solution.
      Regardons pourquoi nous obtenons une solution
      <em>g&#xe9;n&#xe9;rale</em>.
    </p>
    <p>
      Soit <m>y_p</m> et <m>\tilde{y}_p</m> deux solutions particuli&#xe8;res diff&#xe9;rentes &#xe0;
      <xref ref="eq3_5_nh"/>.
      On &#xe9;crit la diff&#xe9;rence <m>w = y_p - \tilde{y}_p</m>.
      On remplace <m>w</m> dans le membre de gauche de l'&#xe9;quation pour obtenir :
      <me>
        w'' + 5w'+ 6w   =   (y_p'' + 5y_p'+ 6y_p) - (\tilde{y}_p'' + 5\tilde{y}_p'+ 6\tilde{y}_p) =  (2x+1) - (2x+1) = 0
      </me>.
    </p>
    <p>
      Quand on utilise la notation des op&#xe9;rateurs lin&#xe9;aires,
      le calcul devient plus simple:
      <me>
        Lw = L(y_p - \tilde{y}_p) =  Ly_p - L\tilde{y}_p = (2x+1)-(2x+1) = 0
      </me>.
    </p>
    <p>
      Alors, <m>w = y_p - \tilde{y}_p</m> est une solution de <xref ref="eq3_5_h"/>;
      autrement dit, <m>Lw = 0</m>.
      Les deux solutions de <xref ref="eq3_5_nh"/> diff&#xe8;rent par une solution &#xe0;
      l'&#xe9;quation homog&#xe8;ne<nbsp/><xref ref="eq3_5_h"/>.
      La solution <m>y = y_c + y_p</m> inclut <em>toutes</em>
      les solutions de <xref ref="eq3_5_nh"/>,
      lorsque <m>y_c</m> est la solution g&#xe9;n&#xe9;rale &#xe0;
      l'&#xe9;quation homog&#xe8;ne associ&#xe9;e.
    </p>
    <theorem>
      <statement>
        <p>
          Soit <m>Ly=f(x)</m> une &#xe9;quation diff&#xe9;rentielle ordinaire lin&#xe9;aire
          (pas n&#xe9;cessairement &#xe0;
          coefficients constants).
          Soit <m>y_c</m> une solution compl&#xe9;mentaire et soit <m>y_p</m> une solution particuli&#xe8;re &#xe0; <m>Ly=f(x)</m>.
          Alors, la solution g&#xe9;n&#xe9;rale de <m>Ly=f(x)</m> est:
          <me>
            y = y_c + y_p
          </me>.
        </p>
      </statement>
    </theorem>
    <p>
      La morale de l'histoire est qu'on peut trouver la solution particuli&#xe8;re de n'importe quelle mani&#xe8;re.
      Si l'on trouve une solution particuli&#xe8;re diff&#xe9;rente
      (avec une m&#xe9;thode diff&#xe9;rente ou simplement en la devinant),
      alors on peut toujours trouver la même solution g&#xe9;n&#xe9;rale.
      La formule pourrait appara&#xee;tre diff&#xe9;rente,
      et les constantes choisies pour satisfaire aux conditions initiales pourraient être diff&#xe9;rentes,
      mais ce serait la même solution.
    </p>
  </subsection>
  <subsection>
    <title>Coefficients ind&#xe9;termin&#xe9;s</title>
    <p>
          <idx><h>undetermined coefficients</h></idx>
    </p>
    <p>
      L'astuce est,
      d'une mani&#xe8;re quelconque ou par un choix judicieux,
      de deviner une solution particuli&#xe8;re &#xe0;
      l'&#xe9;quation<nbsp/><xref ref="eq3_5_nh"/>.
      On note que <m>2x+1</m> est un polynôme et que le membre de gauche de l'&#xe9;quation sera un polynôme si l'on pose que <m>y</m> est un polynôme de même degr&#xe9;. Essayons:
      <me>
        y_p = Ax + B
      </me>.
    </p>
    <p>
      On remplace <m>y_p</m> dans le membre de gauche et l'on obtient:
      <md>
        <mrow>y_p'' + 5y_p'+ 6y_p \amp  = (Ax+B)'' + 5(Ax+B)' + 6(Ax+B)</mrow>
        <mrow>\amp  = 0 + 5A + 6Ax + 6B = 6Ax+ (5A+6B) </mrow>
      </md>.
    </p>
    <p>
      Alors, <m>6Ax+(5A+6B) = 2x+1</m>.
      Donc, <m>A = \nicefrac{1}{3}</m> et <m>B = \nicefrac{-1}{9}</m>.
      Par cons&#xe9;quent,
      <m>y_p = \frac{1}{3}\, x - \frac{1}{9} = \frac{3x-1}{9}</m>.
      En r&#xe9;solvant le probl&#xe8;me compl&#xe9;mentaire (exercice!), on obtient:
      <me>
        y_c = C_1 e^{-2x} + C_2 e^{-3x}
      </me>.
    </p>
    <p>
      Ainsi, la solution g&#xe9;n&#xe9;rale &#xe0;<nbsp/><xref ref="eq3_5_nh"/> est:
      <me>
        y = C_1 e^{-2x} + C_2 e^{-3x} + \frac{3x-1}{9}
      </me>.
    </p>
    <p>
      Supposons maintenant que certaines conditions initiales sont impos&#xe9;es.
      Par exemple, <m>y(0) = 0</m> et <m>y'(0) = \nicefrac{1}{3}</m>.
      D'abord, on trouve que <m>y' = - 2C_1 e^{-2x} - 3C_2 e^{-3x} + \nicefrac{1}{3}</m>.
      Ensuite:
      <me>
        0   = y(0)  = C_1 + C_2 -\frac{1}{9} , \qquad \frac{1}{3} = y'(0) = - 2C_1 - 3C_2 + \frac{1}{3}
      </me>.
    </p>
    <p>
      En r&#xe9;solvant l'&#xe9;quation,
      on obtient <m>C_1 = \nicefrac{1}{3}</m> et <m>C_2 = \nicefrac{-2}{9}</m>.
      La solution particuli&#xe8;re voulue est donc:
      <me>
        y(x) = \frac{1}{3} e^{-2x} - \frac{2}{9} e^{-3x} + \frac{3x-1}{9} = \frac{3 e^{-2x} - 2 e^{-3x} + 3x-1}{9}
      </me>.
    </p>
    <exercise>
      <statement>
        <p>
          V&#xe9;rifiez que <m>y</m> r&#xe9;sout l'&#xe9;quation <xref ref="eq3_5_nh"/> et satisfait aux conditions initiales donn&#xe9;es.
        </p>
      </statement>
    </exercise>
    <p>
      Note: Une erreur fr&#xe9;quente est de r&#xe9;soudre pour des constantes en utilisant les conditions initiales avec <m>y_c</m> et de seulement ajouter la solution particuli&#xe8;re <m>y_p</m> par la suite.
      <em>Ça ne fonctionnera pas</em>.
      Vous devez d'abord calculer <m>y = y_c + y_p</m> et
      <em>seulement ensuite</em>
      r&#xe9;soudre pour les constantes en utilisant les conditions initiales.
    </p>
    <p>
      Lorsque le membre de droite est compos&#xe9;
      d'exponentielles, de sinus ou de cosinus,
      on travaille de mani&#xe8;re semblable.
      Prenons, par exemple:
      <me>
        y''+2y'+2y = \cos (2x)
      </me>.
    </p>
    <p>
      On commence par chercher <m>y_p</m>.
      On devine que la solution inclut un multiple de <m>\cos(2x)</m>.
      On doit aussi ajouter un multiple de
      <m>\sin (2x)</m> puisque la d&#xe9;riv&#xe9;e d'un cosinus est un sinus.
      On essaie donc:
      <me>
        y_p = A \cos (2x) + B \sin (2x)
      </me>.
    </p>
    <p>
      On substitue <m>y_p</m> dans l'&#xe9;quation et l'on obtient:
      <md>
        \underbrace{-4 A \cos (2x) - 4 B \sin (2x)}_{y_p''} +2 \underbrace{\bigl(-2A \sin (2x) + 2B \cos (2x)\bigr)}_{y_p'}  \\ +2 \underbrace{\bigl(A \cos (2x) + 2B \sin (2x)\bigr)}_{y_p} = \cos (2x)
      </md>
      ou
      <me>
        (-4A+4B+2A) \cos(2x) +  (-4B-4A+2B) \sin(2x)   = \cos(2x)
      </me>.
    </p>
    <p>
      Le membre de gauche devrait être &#xe9;gal au membre de droite, &#xe0;
      savoir <m>-4A + 4B + 2A = 1</m> et <m>-4B - 4A + 2B = 0</m>.
      Alors, <m>-2A+4B =1</m> et <m>2A+B=0</m>,
      et aussi <m>A=\nicefrac{-1}{10}</m> et <m>B=\nicefrac{1}{5}</m>.
      Alors:
      <me>
        y_p = A \cos (2x) + B \sin (2x) = \frac{-\cos (2x) + 2 \sin (2x)}{10}
      </me>.
    </p>
    <p>
      De mani&#xe8;re similaire,
      si le membre de droite contient une exponentielle,
      on essaie une exponentielle.
      Par exemple, pour
      <me>
        Ly = e^{3x}
      </me>,
      on essaie <m>y = A e^{3x}</m> et l'on tente de r&#xe9;soudre pour <m>A</m>.
    </p>
    <p>
      Lorsque le membre de droite est un multiple d'un sinus,
      d'un cosinus, d'une exponentielle ou d'un polynôme,
      on peut utiliser la r&#xe8;gle du produit pour d&#xe9;river et arriver &#xe0;
      une expression &#xe0; essayer.
      On a besoin de deviner une forme pour <m>y_p</m> telle que <m>Ly_p</m> est de la même forme,
      et a tous les termes n&#xe9;cessaires pour le membre de droite.
      Par exemple:
      <me>
        Ly = (1+3x^2)\,e^{-x}\cos (\pi x)
      </me>.
    </p>
    <p>
      Pour cette &#xe9;quation, on suppose que:
      <me>
        y_p = (A + Bx + Cx^2)\,e^{-x} \cos (\pi x) + (D + Ex + Fx^2)\,e^{-x} \sin (\pi x)
      </me>.
    </p>
    <p>
      On substitue et l'on obtient les &#xe9;quations &#xe0;
      r&#xe9;soudre pour <m>A</m>,
      <m>B</m>, <m>C</m>, <m>D</m>, <m>E</m> et <m>F</m>.
      Comme on peut le voir, &#xe7;a peut engendrer rapidement un calcul tr&#xe8;s long et fastidieux.
    </p>
    <p>
      Il y a un hic avec tout &#xe7;a.
      Il est possible que la supposition faite r&#xe9;solve l'&#xe9;quation homog&#xe8;ne associ&#xe9;e.
      Consid&#xe9;rons, par exemple:
      <me>
        y'' - 9y = e^{3x}
      </me>.
    </p>
    <p>
      On aimerait poser que <m>y = Ae^{3x}</m>, mais,
      si l'on remplace dans le membre de gauche de l'&#xe9;quation,
      on obtient:
      <me>
        y''-9y = 9Ae^{3x} - 9Ae^{3x} = 0 \not= e^{3x}
      </me>.
    </p>
    <p>
      Il n'y a pas de mani&#xe8;re de choisir <m>A</m> pour que le membre de droite soit <m>e^{3x}</m>.
      L'astuce, dans ce cas,
      est de multiplier notre expression par <m>x</m> pour nous d&#xe9;barrasser de la duplication de la solution compl&#xe9;mentaire.
      Ainsi, nous calculons <m>y_c</m> (solution de <m>Ly = 0</m>),
      <me>
        y_c = C_1 e^{-3x} + C_2 e^{3x}
      </me>,
      et nous notons que le terme <m>e^{3x}</m> est dupliqu&#xe9;
      avec notre expression.
      On la modifie pour qu'elle devienne <m>y = Axe^{3x}</m>,
      et alors il n'y a plus de duplication.
      Essayons: <m>y' = Ae^{3x} + 3Axe^{3x}</m> et <m>y'' = 6Ae^{3x} + 9Axe^{3x}</m>, alors
      <me>
        y'' -9y = 6Ae^{3x} + 9Axe^{3x} - 9Axe^{3x} = 6Ae^{3x}
      </me>.
    </p>
    <p>
      Donc, <m>6Ae^{3x}</m> devrait être &#xe9;gal &#xe0; <m>e^{3x}</m>.
      Ainsi, <m>6A = 1</m>, et alors <m>A=\nicefrac{1}{6}</m>.
      On peut maintenant &#xe9;crire la solution g&#xe9;n&#xe9;rale comme suit:
      <me>
        y = y_c + y_p = C_1 e^{-3x} + C_2 e^{3x} + \frac{1}{6}\,xe^{3x}
      </me>.
    </p>
    <p>
      Il est possible que la multiplication par <m>x</m> n'enl&#xe8;ve pas la duplication.
      Voyons, par exemple:
      <me>
        y''-6y'+9y = e^{3x}
      </me>.
    </p>
    <p>
      La solution compl&#xe9;mentaire est <m>y_c = C_1 e^{3x} + C_2 x e^{3x}</m>.
      Poser <m>y=A xe^{3x}</m> ne r&#xe9;glera pas le probl&#xe8;me.
      Dans ce cas, on veut supposer que <m>y_p = Ax^2e^{3x}</m>.
      Ainsi, nous voulons multiplier notre expression par <m>x</m> jusqu'&#xe0;
      ce qu'il n'y ait plus de duplication.
      <em>Mais pas plus!</em> Multiplier trop de fois ne fonctionnera pas plus.
    </p>
    <p>
      Finalement, si le membre de droite a diff&#xe9;rents termes tels que
      <me>
        Ly = e^{2x} + \cos x
      </me>,
      dans ce cas, on trouve <m>u</m> qui r&#xe9;sout
      <m>Lu = e^{2x}</m> et <m>v</m> qui r&#xe9;sout <m>Lv = \cos x</m>
      (faire chaque terme s&#xe9;par&#xe9;ment).
      On note que si <m>y = u+ v</m>,
      alors <m>Ly = e^{2x} + \cos x</m> puisque <m>L</m> est lin&#xe9;aire;
      donc, <m>Ly = L(u+v) = Lu + Lv = e^{2x} + \cos x</m>.
    </p>
  </subsection>
  <subsection>
    <title>Variation des param&#xe8;tres</title>
    <p>
      La m&#xe9;thode des coefficients ind&#xe9;termin&#xe9;s fonctionne pour plusieurs probl&#xe8;mes de base.
      Mais elle fonctionne seulement lorsque le membre de droite de l'&#xe9;quation
      <m>Ly = f(x)</m> admet un nombre limit&#xe9;
      de d&#xe9;riv&#xe9;es lin&#xe9;airement ind&#xe9;pendantes; &#xe0;
      ce moment-l&#xe0;, on peut &#xe9;crire une expression qui les contient toutes.
      Quelques &#xe9;quations sont un peu plus difficiles.
      Consid&#xe9;rons, par exemple:
      <me>
        y''+y = \tan x
      </me>.
    </p>
    <p>
      Toutes les nouvelles d&#xe9;riv&#xe9;es de <m>\tan x</m> sont compl&#xe8;tement diff&#xe9;rentes et ne peuvent pas s'&#xe9;crire comme une combinaison lin&#xe9;aire des d&#xe9;riv&#xe9;es pr&#xe9;c&#xe9;dentes.
      Si l'on commence par d&#xe9;river <m>\tan x</m>, on obtient:
      <md>
        \sec^2 x, 2 \sec^2 x \, \tan x, 4 \sec^2 x \, \tan^2 x + 2 \sec^4 x, \\ 8 \sec^2 x \, \tan^3 x + 16 \sec^4 x \, \tan x, 16\sec^2 x \, \tan^4 x + 88 \sec^4 x \tan^2 x + 16 \sec^6 x \ldots
      </md>
    </p>
    <p>
      Cette &#xe9;quation fait appel &#xe0;
      une m&#xe9;thode diff&#xe9;rente:
      la m&#xe9;thode de la <em>variation des param&#xe8;tres<idx><h>variation des param&#xe8;tres</h></idx>
      </em>, qui g&#xe8;re toute &#xe9;quation de la forme <m>Ly = f(x)</m>, &#xe0;
      condition de pouvoir r&#xe9;soudre certaines int&#xe9;grales.
      Pour plus de simplicit&#xe9;, on se limite aux &#xe9;quations &#xe0;
      coefficients constants du deuxi&#xe8;me ordre,
      mais la m&#xe9;thode fonctionne aussi bien pour les ordres sup&#xe9;rieurs
      (les calculs deviennent plus fastidieux).
          <idx><h>fastidieux</h></idx>
      La m&#xe9;thode fonctionne aussi pour des &#xe9;quations &#xe0;
      coefficients non constants, &#xe0;
      condition qu'on puisse r&#xe9;soudre l'&#xe9;quation homog&#xe8;ne associ&#xe9;e.
    </p>
    <p>
      Il est peut-être pr&#xe9;f&#xe9;rable d'expliquer cette m&#xe9;thode par un exemple.
      On essaie de r&#xe9;soudre l'&#xe9;quation:
      <me>
        Ly = y''+y = \tan x
      </me>.
    </p>
    <p>
      D'abord, on trouve la solution compl&#xe9;mentaire
      (solution &#xe0; <m>Ly_c = 0</m>).
      On obtient <m>y_c = C_1 y_1 + C_2 y_2</m>,
      où <m>y_1 = \cos x</m> et <m>y_2 = \sin x</m>.
      On trouve une solution particuli&#xe8;re &#xe0;
      l'&#xe9;quation non homog&#xe8;ne et l'on trouve:
      <me>
        y_p = y = u_1 y_1 + u_2 y_2
      </me>,
      où <m>u_1</m> et <m>u_2</m> sont des
      <em>fonctions</em> et pas des constantes.
      On essaie de satisfaire &#xe0;
      <m>Ly = \tan x</m>,
      ce qui donne les conditions pour les fonctions <m>u_1</m> et <m>u_2</m>.
      On calcule (r&#xe8;gle du produit):
      <me>
        y' = (u_1' y_1 + u_2' y_2) + (u_1 y_1' + u_2 y_2')
      </me>.
    </p>
    <p>
      Nous pouvons toujours imposer une condition suppl&#xe9;mentaire, &#xe0;
      notre discr&#xe9;tion, pour simplifier les calculs
      (nous avons deux fonctions inconnues,
      alors nous pouvons ajouter deux conditions).
      On a besoin que <m>(u_1' y_1 + u_2' y_2) = 0</m>.
      Ceci rend les calculs de la deuxi&#xe8;me d&#xe9;riv&#xe9;e plus faciles:
      <md>
        <mrow>\amp  y' = u_1 y_1' + u_2 y_2' ,</mrow>
        <mrow>\amp  y'' = (u_1' y_1' + u_2' y_2') + (u_1 y_1'' + u_2 y_2'') </mrow>
      </md>.
    </p>
    <p>
      Puisque <m>y_1</m> et <m>y_2</m> sont des solutions de <m>y''+y = 0</m>,
      on trouve <m>y_1'' = - y_1</m> et
      <m>y_2'' = - y_2</m> (si l'&#xe9;quation &#xe9;tait plus g&#xe9;n&#xe9;rale,
      <m>y''+p(x)y' +q(x)y = 0</m>,
      on aurait <m>y_i'' = -p(x)y_i' -q(x)y_i</m>).
      Alors:
      <me>
        y'' = (u_1' y_1' + u_2' y_2') - (u_1 y_1 + u_2 y_2)
      </me>.
    </p>
    <p>
      On a <m>(u_1 y_1 + u_2 y_2) = y</m>, et alors
      <me>
        y'' = (u_1' y_1' + u_2' y_2') - y
      </me>
      et ainsi
      <me>
        y'' + y = Ly = u_1' y_1' + u_2' y_2'
      </me>.
    </p>
    <p>
      Pour que <m>y</m> satisfasse &#xe0;
      <m>Ly = f(x)</m>, on doit avoir <m>f(x) = u_1' y_1' + u_2' y_2'</m>.
    </p>
    <p>
      On doit r&#xe9;soudre les deux &#xe9;quations (conditions) qu'on a impos&#xe9;es &#xe0;
      <m>u_1</m> et &#xe0; <m>u_2</m>:
      <me>
        \mybxbg{~~ \begin{aligned} \amp  u_1' y_1 + u_2' y_2 = 0 ,\\ \amp  u_1' y_1' + u_2' y_2' = f(x) . \end{aligned}~~}
      </me>
    </p>
    <p>
      On r&#xe9;sout pour <m>u_1'</m> et <m>u_2'</m> en termes de <m>f(x)</m>,
      <m>y_1</m> et <m>y_2</m>.
      On obtient toujours cette formule pour n'importe quel <m>Ly = f(x)</m>,
      où <m>Ly = y''+p(x)y'+q(x)y</m>.
      Il y a une formule g&#xe9;n&#xe9;rale pour la solution qu'on peut remplacer, mais,
      au lieu de la m&#xe9;moriser,
      c'est mieux et plus facile de simplement r&#xe9;p&#xe9;ter ce qu'on a fait pr&#xe9;c&#xe9;demment.
      Dans ce cas, les deux &#xe9;quations sont:
      <md>
        <mrow>u_1' \cos (x) + u_2' \sin (x) \amp = 0 ,</mrow>
        <mrow>-u_1' \sin (x) + u_2' \cos (x) \amp = \tan (x) </mrow>
      </md>.
    </p>
    <p>
      Ainsi:
      <md>
        <mrow>u_1' \cos (x) \sin (x) + u_2' \sin^2 (x) \amp  = 0 ,</mrow>
        <mrow>-u_1' \sin (x) \cos (x) + u_2' \cos^2 (x) \amp  = \tan (x) \cos (x) = \sin (x) </mrow>
      </md>.
    </p>
    <p>
      Et alors:
      <md>
        <mrow>\amp  u_2' \bigl(\sin^2 (x) + \cos^2 (x)\bigr) = \sin (x) ,</mrow>
        <mrow>\amp  u_2' = \sin (x) ,</mrow>
        <mrow>\amp  u_1' = \frac{- \sin^2 (x)}{\cos (x)} = - \tan (x) \sin (x) </mrow>
      </md>.
    </p>
    <p>
      On int&#xe8;gre <m>u_1'</m> et <m>u_2'</m> pour obtenir <m>u_1</m> et <m>u_2</m>:
      <md>
        <mrow>\amp  u_1 = \int u_1'\,dx   = \int - \tan (x) \sin (x)\,dx = \frac{1}{2} \ln \left\lvert \frac{\sin (x)-1}{\sin (x) + 1} \right\rvert   + \sin (x) ,</mrow>
        <mrow>\amp  u_2 = \int u_2'\,dx   = \int \sin (x)\,dx = -\cos (x) </mrow>
      </md>.
    </p>
    <p>
      Alors, la solution particuli&#xe8;re est :
      <md>
        <mrow>y_p \amp = u_1 y_1 + u_2 y_2 = \frac12 \cos (x) \ln \left\lvert \frac{\sin (x)-1}{\sin (x) + 1}  \right\rvert + \cos (x) \sin (x) -\cos (x) \sin (x)</mrow>
        <mrow>\amp =   \frac12 \cos (x) \ln \left\lvert \frac{\sin (x)-1}{\sin (x) + 1} \right\rvert </mrow>
      </md>.
    </p>
    <p>
      La solution g&#xe9;n&#xe9;rale &#xe0;
      <m>y'' + y = \tan x</m> est:
      <me>
        y = C_1 \cos (x) + C_2 \sin (x) + \frac{1}{2} \cos (x) \ln \left\lvert \frac{\sin (x)-1}{\sin (x) + 1} \right\rvert
      </me>.
    </p>
  </subsection>
  <subsection>
    <title>Exercices</title>
    <exercise>
      <statement>
        <p>
          Trouvez une solution particuli&#xe8;re de <m>y''-y' -6y = e^{2x}</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Trouvez une solution particuli&#xe8;re de <m>y''-4y' +4y = e^{2x}</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          R&#xe9;solvez le probl&#xe8;me &#xe0;
          valeurs initiales <m>y''+9y = \cos (3x) + \sin (3x)</m> for <m>y(0) = 2</m>,
          <m>y'(0) = 1</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Configurez la forme de la solution particuli&#xe8;re
          (mais ne r&#xe9;solvez pas pour les coefficients)
          <m>y^{(4)}-2y'''+y'' = e^x</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Configurez la forme de la solution particuli&#xe8;re (mais ne r&#xe9;solvez pas pour les coefficients)<m>y^{(4)}-2y'''+y'' = e^x + x + \sin x</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <title>2</title>
      <statement>
        <p>
          \begin{tasks} \task Utilisez la variation des param&#xe8;tres pour trouver une solution particuli&#xe8;re de
          <m>y''-2y'+y = e^x</m>. \task Trouvez une solution particuli&#xe8;re en utilisant les coefficients ind&#xe9;termin&#xe9;s. \task Est-ce que les deux solutions que vous avez trouv&#xe9;es sont les mêmes?
          V&#xe9;rifiez <xref ref="exercise_diffvarparunder">aussi</xref>. \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Trouvez une solution particuli&#xe8;re de <m>y''-2y' +y = \sin (x^2)</m>.
          C'est correct de laisser une int&#xe9;grale d&#xe9;finie comme r&#xe9;ponse.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Pour une constante arbitraire <m>c</m> trouvez une solution particuli&#xe8;re &#xe0; <m>y''-y=e^{cx}</m>.
          Astuce : Assurez-vous de g&#xe9;rer tous les r&#xe9;els <m>c</m> possibles .
        </p>
      </statement>
    </exercise>
    <exercise xml:id="exercise_diffvarparunder">
      <statement>
        <p>
          [2] \begin{tasks} \task Utilisez la variation des param&#xe8;tres pour trouver une solution particuli&#xe8;re de
          <m>y''-y = e^x</m>. \task Trouvez une solution particuli&#xe8;re en utilisant les coefficients ind&#xe9;termin&#xe9;s. \task Est-ce que les deux solutions que vous avez trouv&#xe9;es sont les mêmes?
          Que se passe-t-il? \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Trouvez une solution particuli&#xe8;re de <m>y''-y'+y=2\sin(3x)</m>
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>y=\frac{-16\sin(3x)+6\cos(3x)}{73}</m> }
    </p>
    <p>
      \begin{samepage}
    </p>
    <exercise>
      <statement>
        <p>
          \begin{tasks} \task Trouvez une solution particuli&#xe8;re de
          <m>y''+2y=e^x + x^3</m>. \task Trouvez une solution g&#xe9;n&#xe9;rale. \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \end{samepage} \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> a)
      <m>y=\frac{2e^x+3x^3-9x}{6}</m> b) <m>y=C_1 \cos(\sqrt{2} x) + C_2 \sin(\sqrt{2} x) + \frac{2e^x+3x^3-9x}{6}</m> }
    </p>
    <exercise>
      <statement>
        <p>
          R&#xe9;solvez <m>y''+2y'+y = x^2</m>,
          <m>y(0)=1</m>, <m>y'(0)=2</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>y(x) = x^2-4 x+6+e^{-x}(x-5)</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Utilisez la variation des param&#xe8;tres pour trouver une solution particuli&#xe8;re de f <m>y''-y = \frac{1}{e^x+e^{-x}}</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>y = \frac{2xe^x-(e^x+e^{-x})\log(e^{2x}+1)}{4}</m> }
    </p>
    <exercise>
      <statement>
        <p>
          Pour une constante arbitraire <m>c</m> trouvez la solution g&#xe9;n&#xe9;rale de <m>y''-2y=\sin(x+c)</m>.
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> <m>y=\frac{-\sin(x+c)}{3}+C_1 e^{\sqrt{2}\,x}+C_2 e^{-\sqrt{2}\,x}</m> }
    </p>
  </subsection>
</section>