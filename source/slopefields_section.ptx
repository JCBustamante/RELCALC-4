<section xml:id="slopefields_section">
  <title>Champs de direction</title>
  <introduction>
    <p>
      Rappelons que l'&#xe9;quation g&#xe9;n&#xe9;rale du premier ordre s'&#xe9;crit comme suit :
      <me>
        y' = f(x , y)
      </me>.
    </p>
    <p>
      Souvent, on ne peut tout simplement pas trouver une solution analytique &#xe0; cette &#xe9;quation.
      Mais on aimerait au moins avoir une id&#xe9;e de la forme et du comportement de la solution,
      ou trouver une solution approximative.
    </p>
  </introduction>
  <subsection>
    <title>Champs de direction</title>
    <p>
      L'&#xe9;quation <m>y' = f(x , y)</m> donne une formule pour la pente de la tangente &#xe0; une solution &#xe0;
      chaque point du plan <m>(x , y)</m>.
      Autrement dit, si <m>y(x)</m> est une solution,
      alors son graphe passe par le point <m>(x , y)</m>,
      et la pente de la tangente au graphe &#xe0;
      ce point est donn&#xe9;e par <m>f(x , y)</m>.
      La solution exacte au point <m>(x , y)</m> est approxim&#xe9;e par une droite de pente <m>f(x , y)</m>,
      alors on place un petit segment de droite ayant cette pente, &#xe0; ce point.
      Par exemple, si <m>f(x , y) = xy</m>,
      alors, au point <m>(2 , 1,5)</m>,
      on trace une petite ligne de pente <m>xy = 2 \times 1,5 = 3</m>.
      Si <m>y(x)</m> est une solution et que <m>y(2) = 1,5</m>,
      l'&#xe9;quation diff&#xe9;rentielle impose la condition <m>y'(2) = 3</m>.
      Voir <xref ref="x1_3_fig0">la</xref>.
    </p>
    <figure xml:id="x1_3_fig0">
      <caption>La  tangente au point <m>(2 , 1,5)</m>, dont la pente est <m>y'=xy</m>.</caption>
      \diffyincludegraphics{width=3in}{width=4.5in}{1-3-xysl-one}
    </figure>
    <p>
      Pour visualiser le comportement des solutions,
      on trace de tels segments de droite &#xe0;
      plusieurs points du plan
      (id&#xe9;alement, on voudrait voir la tangente &#xe0;
      chaque point du plan, ce qui est &#xe9;videmment impossible).
      Typiquement, on se donne un grillage de points,
      suffisamment fin pour qu'on voie le comportement des solutions,
      mais pas trop, sinon on ne voit plus les segments individuels.
      On appelle une telle figure le <em>champ de directions
          <idx><h>champ de directions</h></idx>
      </em> pour l'&#xe9;quation.
      <xref ref="x1_3_fig1">La</xref> montre le champ de directions pour l'&#xe9;quation <m>y' = xy</m> . Habituellement,
      on laissera &#xe0;
      un ordinateur le soin de tracer une telle figure.
    </p>
    <p>
      Supposons que nous nous faisons donner une condition initiale,
      <m>y(x_0) = y_0</m>.
      Une solution, c'est-&#xe0;-dire le graphe d'une solution,
      est une courbe tangente aux segments de droite qu'on a dessin&#xe9;s.
      Quelques exemples de solutions sont donn&#xe9;s &#xe0;
      <xref ref="x1_3_fig2">la</xref>.
      On peut tracer grosso modo une solution dans le champ de directions,
      juste en regardant les directions.
      Il suffit de tracer une courbe qui passe par la condition initiale et qui est &#xe0;
      peu pr&#xe8;s tangente aux segments du champ de directions.
    </p>
    <figure xml:id="x1_3_fig1">
      <caption>Champ de directions pour <m>y' = xy</m>.</caption>
      \diffyincludegraphics{width=3.0in}{width=4.5in}{1-3-xysl}
      <nbsp/><nbsp/>
      \diffyincludegraphics{width=3.0in}{width=4.5in}{1-3-xysl-sol}
      \caption{Champ de directions pour <m>y' = xy</m>, avec les graphes de solutions satisfaisant &#xe0; <m>y(0) = 0,2</m>, <m>y(0) = 0</m> et <m>y(0) = -0,2</m>.}
    </figure>
    <p>
      L'observation du champ de directions suffit pour avoir beaucoup d'information sur le comportement des solutions.
      Par exemple, <xref ref="x1_3_fig2">la</xref>
      nous montre le comportement des solutions selon que <m>y(0) > 0</m>,
      <m>y(0) = 0</m> ou <m>y(0) \lt 0</m>.
      Un petit changement dans la condition initiale peut entra&#xee;ner des diff&#xe9;rences appr&#xe9;ciables dans le comportement des solutions.
      Et l'on peut le voir juste en regardant le champ de directions et en imaginant ce que font les solutions.
    </p>
    <p>
      Le comportement est tout autre avec l'&#xe9;quation <m>y' = -y</m>.
      <xref ref="x1_3_fig3">La</xref> montre le champ de directions de cette &#xe9;quation,
      ainsi que quelques solutions.
      Lorsqu'on se d&#xe9;place de gauche &#xe0;
      droite (dans la direction où <m>x</m> augmente),
      on voit que, quelle que soit la valeur de <m>y(0)</m>,
      toutes les solutions tendent vers 0 lorsque <m>x</m> tend vers l'infini.
      Ce comportement s'observe bien du champ de directions,
      sans devoir r&#xe9;soudre l'&#xe9;quation explicitement.
    </p>
    <figure xml:id="x1_3_fig3">
      <caption>Champ de directions pour <m>y' = -y</m>, avec le graphe de quelques solutions.</caption>
      \diffyincludegraphics{width=3in}{width=4.5in}{1-3-mysl-sol}
    </figure>
  </subsection>
  <subsection>
    <title>Existence et unicit&#xe9;</title>
    <p>
      Nous allons consid&#xe9;rer maintenant deux questions fondamentales &#xe0;
      propos de l'&#xe9;quation
      <me>
        y' = f(x,y), \qquad y(x_0) = y_0
      </me>.
      <ol label="i">
        <li>
          <p>
            Est-ce qu'une solution <em>existe</em>?
          </p>
        </li>
        <li>
          <p>
            Si elle existe, est-ce que la solution est <em>unique</em>?
          </p>
        </li>
      </ol>
    </p>
    <p>
      Avant de continuer, essayez de r&#xe9;pondre &#xe0; ces questions.
    </p>
    <p>
      Tous les exemples vus jusqu'ici pourraient vous faire croire que la r&#xe9;ponse est oui aux deux questions.
      Mais ce n'est pas toujours le cas.
    </p>
    <p>
      Pour les &#xe9;quations d&#xe9;crivant des lois de la nature,
      on s'attend &#xe0;
      ce qu'une solution existe.
      Cette solution devrait aussi être unique,
      du moins si l'on croit en un univers d&#xe9;terministe.
      Si aucune solution n'existe,
      ou si elle n'est pas unique,
      il y a probablement un probl&#xe8;me avec le mod&#xe8;le.
      C'est donc pertinent de saisir les conditions dans lesquelles une solution unique existe.
    </p>
    <example>
      <statement>
        <p>
          Essayons de r&#xe9;soudre l'&#xe9;quation suivante:
          <me>
            y' = \frac{1}{x},  \qquad  y(0) = 0
          </me>.
        </p>
        <p>
          En int&#xe9;grant,
          on trouve la solution g&#xe9;n&#xe9;rale <m>y = \ln \, \lvert x \rvert + C</m>.
          Mais cette solution n'est pas d&#xe9;finie en <m>x=0</m>.
          Voir <xref ref="x1_3_xinvfig">la</xref>.
          On aurait pu &#xe9;crire l'&#xe9;quation comme
          <m>x y' = 1</m> et l'on pourrait croire que la solution devrait être jolie.
        </p>
        <figure xml:id="x1_3_xinvfig">
          <caption>Champ de directions pour <m>y' = \nicefrac{1}{x}</m>.</caption>
          \diffyincludegraphics{width=3in}{width=4.5in}{1-3-xinv-sol}
          <nbsp/><nbsp/>
          \diffyincludegraphics{width=3in}{width=4.5in}{1-3-sqrt-sol}
          \caption{Champ de directions pour <m>y' = 2 \sqrt{\lvert y \rvert}</m>, avec deux solutions satisfaisant &#xe0; <m>y(0) = 0</m>. }
        </figure>
      </statement>
    </example>
    <example>
      <statement>
        <p>
          R&#xe9;solvons:
          <me>
            y' = 2 \sqrt{\lvert y \rvert}, \qquad y(0) = 0
          </me>.
        </p>
        <p>
          Voir <xref ref="x1_3_sqrtfig">la</xref>.
          Remarquons que <m>y=0</m> est une solution.
          Et en voici une autre:
          <me>
            y(x) =  \begin{cases} x^2 \amp  \text{ si }  \; x \geq 0,\\ -x^2 \amp  \text{ si }  \; x \lt  0. \end{cases}
          </me>
        </p>
      </statement>
    </example>
    <p>
      Si l'on se fie au champ de directions,
      il peut être difficile de se rendre compte que la solution n'est pas unique.
      Que faire?
      Heureusement, on a le th&#xe9;or&#xe8;me de Picard<m>\!</m><fn>
      <url href="https://fr.wikipedia.org/wiki/Charles_%C3%89mile_Picard">Charles &#xc9;mile Picard</url>,
      math&#xe9;maticien fran&#xe7;ais (1856-1941).
      </fn>.
    </p>
    <theorem xml:id="slope_picardthm">
      <title>Th&#xe9;or&#xe8;me d'existence et d'unicit&#xe9; de Picard</title>
      <statement>
        <p>
              <idx><h>existence et unicit&#xe9;</h></idx>
              <idx><h>th&#xe9;or&#xe8;me de Picard</h></idx>
          Si <m>f(x , y)</m> est une fonction continue en <m>(x , y)</m> et que <m>\frac{\partial f}{\partial y}</m> existe dans un voisinage d'un point <m>(x_0 , y_0)</m>, alors il existe une solution &#xe0; l'&#xe9;quation diff&#xe9;rentielle
          <me>
            y' = f(x,y), \qquad y(x_0) = y_0
          </me>,
        </p>
        <p>
          (possiblement dans un petit intervalle de valeurs de <m>x</m>) et,
          de plus, la solution est unique.
        </p>
      </statement>
    </theorem>
    <p>
      Observons que les &#xe9;quations des deux exemples pr&#xe9;c&#xe9;dents,
      <m>y' = \nicefrac{1}{x}</m>,
      <m>y(0) = 0</m> et <m>y' = 2 \sqrt{\lvert y \rvert}</m>,
      <m>y(0) = 0</m>,
      ne satisfont pas aux conditions du th&#xe9;or&#xe8;me de Picard.
      Même lorsque le th&#xe9;or&#xe8;me s'applique,
      il faut faire attention puisque la solution ne sera possiblement pas d&#xe9;finie pour toutes les valeurs r&#xe9;elles de <m>x</m>.
    </p>
    <example>
      <statement>
        <p>
          R&#xe9;solvons:
          <me>
            y' = y^2, \qquad y(0) = A
          </me>,
          où <m>A</m> est une constante quelconque.
        </p>
        <p>
          On peut r&#xe9;soudre cette &#xe9;quation avec les outils que nous avons d&#xe9;j&#xe0; vus.
          D'abord, supposons que <m>A \not= 0</m>;
          alors, <m>y</m> est diff&#xe9;rent de 0 pour des valeurs de <m>x</m> proches de 0.
          Nous pouvons donc r&#xe9;&#xe9;crire l'&#xe9;quation : <m>x' = \nicefrac{1}{y^2}</m>,
          ce qui nous donne, en int&#xe9;grant,
          <m>x = \nicefrac{-1}{y} + C</m>,
          et donc <m>y = \frac{1}{C-x}</m>.
          Si <m>y(0) = A</m>, alors <m>C = \nicefrac{1}{A}</m>, et donc
          <me>
            y = \frac{1}{\nicefrac{1}{A} - x}
          </me>.
        </p>
        <p>
          Lorsque <m>A=0</m>, <m>y=0</m> est une solution.
        </p>
        <p>
          Lorsque <m>A=1</m>, par exemple,
          la solution explose &#xe0; <m>x=1</m>.
          Ainsi, une solution existe,
          mais elle n'est pas d&#xe9;finie pour toute valeur de <m>x</m>, et ce,
          même si l'&#xe9;quation <m>y' = y^2</m> semble plutôt innocente.
        </p>
      </statement>
    </example>
    <p>
      Dans ce manuel,
      nous consid&#xe9;rerons principalement des &#xe9;quations dont la solution existe et est unique pour toutes les valeurs de la variable ind&#xe9;pendante.
    </p>
  </subsection>
  <subsection>
    <title>Exercices</title>
    <exercise>
      <statement>
        <p>
          Dessinez un champ de directions pour <m>y'=e^{x-y}</m>.
          Comment se comportent les solutions lorsque <m>x</m> augmente?
          Pouvez-vous deviner une solution particuli&#xe8;re en regardant le champ de directions?
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Dessinez un champ de directions pourr <m>y'=x^2</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Dessinez un champ de directions pour <m>y'=y^2</m>.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Peut-on r&#xe9;soudre <m>y' = \frac{xy}{\cos x}</m>, <m>y(0) = 1</m>?
          Justifiez votre r&#xe9;ponse.
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Peut-on r&#xe9;soudre <m>y' = y\sqrt{\lvert x\rvert}</m>,
          <m>y(0) = 0</m>?
          La solution est-elle unique?
          Justifiez votre r&#xe9;ponse.
        </p>
      </statement>
    </exercise>
    <p>
      \begin{samepage}
    </p>
    <exercise>
      <statement>
        <p>
          Associez les &#xe9;quations suivantes <m>y'=1-x</m>,
          <m>y'=x-2y</m>, <m>y' = x(1-y)</m> &#xe0;
          leurs champs de directions respectifs.
          Justifiez votre r&#xe9;ponse. \begin{tasks}(3) \task <image width="32%" source="images/yprimex1minusyslope.png"/> \task <image width="32%" source="images/yprime1minusxslope.png"/> \task <image width="32%" source="images/yprimexminus2yslope.png"/> \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \end{samepage}
    </p>
    <exercise>
      <title>d&#xe9;fi</title>
      <statement>
        <p>
          Soit <m>y' = f(x,y)</m>, <m>y(0) = 0</m>,
          tel que <m>f(x,y) > 1</m> pour tous <m>x</m> et <m>y</m>.
          Si la solution existe pour tout <m>x</m>, que peut-on dire &#xe0;
          propos de <m>y(x)</m> lorsque <m>x</m> tend vers l'infini?
          Expliquez.
        </p>
      </statement>
    </exercise>
    <exercise>
      <title>d&#xe9;fi</title>
      <statement>
        <p>
          Soit <m>(y-x)y' = 0</m>,
          <m>y(0) = 0</m>. \begin{tasks} \task Trouvez deux solutions distinctes. \task Expliquez pourquoi ceci ne contredit pas le th&#xe9;or&#xe8;me de Picard. \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Soit <m>y' = f(x,y)</m>.
          Dites ce que vous savez &#xe0;
          propos de son champ de directions,
          et dessinez un exemple, si vous avez l'information suivante &#xe0;
          propos de <m>f(x,y)</m>: \begin{tasks}(2) \task <m>f</m> ne d&#xe9;pend pas de <m>y</m>. \task <m>f</m> ne d&#xe9;pend pas de <m>x</m>. \task
          <m>f(t,t) = 0</m> pour toute valeur <m>t</m>. \task <m>f(x,0) = 0</m> et
          <m>f(x,1) = 1</m> pour tout <m>x</m>. \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Trouvez une solution &#xe0; <m>y' = \lvert y \rvert</m>,
          <m>y(0) = 0</m>.
          Peut-on appliquer le th&#xe9;or&#xe8;me de Picard?
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Soit <m>y' = (y-2x) g(x,y) + 2</m>,
          où <m>g(x,y)</m> est une fonction quelconque.
          Pouvez-vous r&#xe9;soudre l'&#xe9;quation avec condition initiale <m>y(0) = 0</m>,
          et si oui, quelle est la solution?
        </p>
      </statement>
    </exercise>
    <exercise>
      <title>d&#xe9;fi</title>
      <statement>
        <p>
          [2] Soit <m>y' = f(x,y)</m> tel que <m>f(x,1) = 0</m> pour tout <m>x</m>,
          <m>f</m> est continue et <m>\frac{\partial f}{\partial y}</m> existe et est continue pour tous <m>x</m> et <m>y</m>. \begin{tasks} \task Devinez une solution pour la condition initiale
          <m>y(0) = 1</m>. \task Les graphes de deux solutions ayant des conditions initiales diff&#xe9;rentes peuvent-elles s'intersecter? \task En supposant que
          <m>y(0) = 0</m>, que peut-on dire &#xe0;
          propos de la solution?
          En particulier, peut-on avoir
          <m>y(x) > 1</m> pour un certain <m>x</m>?
          Peut-on avoir <m>y(x) = 1</m> pour un certain <m>x</m>?
          Pourquoi ou pourquoi pas? \end{tasks}
        </p>
      </statement>
    </exercise>
    <exercise>
      <statement>
        <p>
          Dessiner le champ de directions pour <m>y'=y^3</m>.
          Pouvez-vous identifier visuellement une solution telle que <m>y(0)=0</m>?
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> }
    </p>
    <p>
      <image width="37%" source="images/yprimey3slope.png"/>
    </p>
    <p>
      <m>y=0</m> est une solution telle que <m>y(0)=0</m>. }
    </p>
    <exercise>
      <statement>
        <p>
          Est-il possible de r&#xe9;soudre <m>y' = xy</m>, <m>y(0) = 0</m>?
          La solution est-elle unique?
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> Oui une solution existe.
      Car <m>y' = f(x,y)</m> où <m>f(x,y) = xy</m>.
      La fonction <m>f(x,y)</m> est continue et <m>\frac{\partial f}{\partial y} = x</m>,
      qui est aussi continue pr&#xe8;s de <m>(0,0)</m>.
      Par cons&#xe9;quent,
      la solution existe et est unique. (En fait <m>y=0</m> est une solution). }
    </p>
    <exercise>
      <statement>
        <p>
          Peut-on r&#xe9;soudre <m>y' = \frac{x}{x^2-1}</m>, <m>y(1) = 0</m>?
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> Non puisque la seule solution possible n'est pas d&#xe9;finie au point <m>(x,y) = (1,0)</m>. }
    </p>
    <p>
      \begin{samepage}
    </p>
    <exercise>
      <statement>
        <p>
          Associez les &#xe9;quations suivantes,
          <m>y'=\sin x</m>, <m>y'=\cos y</m>,
          <m>y' = y\cos(x)</m> &#xe0;
          leurs champs de directions respectifs.
          Justifiez votre r&#xe9;ponse. \begin{tasks}(3) \task <image width="32%" source="images/yprimecosyslope.png"/> \task <image width="32%" source="images/yprimecosxyslope.png"/> \task <image width="32%" source="images/yprimesinxslope.png"/> \end{tasks}
        </p>
      </statement>
    </exercise>
    <p>
      \end{samepage} \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> a) <m>y'=\cos y</m>,
      b) <m>y' = y\cos(x)</m>, c) <m>y'=\sin x</m>. }
    </p>
    <exercise>
      <title>d&#xe9;fi</title>
      <statement>
        <p>
          Supposons que
          <me>
            f(y) = \begin{cases} 0 \amp  \text{ si \(y > 0\) } , \\ 1 \amp  \text{ si \(y \leq 0\) }  . \end{cases}
          </me>
        </p>
        <p>
          Est-ce que <m>y' = f(y)</m>,
          <m>y(0) = 0</m> admet une solution dont la d&#xe9;riv&#xe9;e est continue?
          Le th&#xe9;or&#xe8;me de Picard s'applique-t-il?
          Pourquoi ou pourquoi pas?
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> Picard ne s'applique pas puisque <m>f</m> n'est pas continue en <m>y=0</m>.
      De plus, l'&#xe9;quation n'admet pas de solution dont la d&#xe9;riv&#xe9;e est continue.
      Car si c'&#xe9;tait vrai, alors il s'ensuivrait que <m>y'(0) = 1</m>.
      Par le test de la premi&#xe8;re d&#xe9;riv&#xe9;e,
      <m>y(x) > 0</m> pour de petites valeurs positives de <m>x</m>.
      Mais on a que <m>y'(x) = 0</m> pour ces valeurs de <m>x</m>,
      et donc <m>y'</m> n'est pas continue. }
    </p>
    <exercise>
      <statement>
        <p>
          Consid&#xe9;rons une &#xe9;quation de la forme <m>y' = f(x)</m>,
          où <m>f</m> est une fonction continue quelconque,
          avec condition initiale <m>y(x_0) = y_0</m>.
          Existe-t-il une solution pour tout <m>x</m>?
          Pourquoi ou pourquoi pas?
        </p>
      </statement>
    </exercise>
    <p>
      \setbox\answerscollect=\vbox{\unvbox\answerscollect \theanswer<nbsp/><nbsp/> La solution est <m>y(x) = \int_{x_0}^x f(s) \,ds + y_0</m>,
      ce qui existe pour toute valeur de <m>x</m>. }
    </p>
  </subsection>
</section>